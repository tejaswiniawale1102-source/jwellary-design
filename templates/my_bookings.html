{% extends 'base.html' %}

{% block title %}My Bookings - RentEasy India{% endblock %}

{% block content %}
<section style="padding: 60px 40px; max-width: 1200px; margin: 0 auto;">
    <div class="reveal" style="text-align: center; margin-bottom: 50px; padding-top: 40px;">
        <h2 style="font-size: 3rem; font-family: 'Playball', cursive; color: #ff1f6a; margin-bottom: 10px;">My Rental
            Journey</h2>
        <p style="color: #888;">Track your bookings and relive your special moments.</p>
    </div>

    {% if bookings and bookings|length > 0 %}
    <div
        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px; padding-bottom: 60px;">
        {% for booking in bookings %}
        <div class="booking-card glass-card reveal"
            style="background: white; border-radius: 25px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.05); transition: 0.3s; position: relative;">
            <div
                style="background: #8b2c4a; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: 600; font-size: 0.9rem; opacity: 0.9;">ORDER #{{ booking[0] }}</span>
                <span class="status-badge"
                    style="background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 30px; font-size: 0.8rem; font-weight: 600;">{{
                    booking[6] }}</span>
            </div>

            <div style="padding: 25px; display: flex; gap: 20px;">
                <img src="{{ booking[7] }}" alt="{{ booking[1] }}"
                    style="width: 100px; height: 100px; object-fit: cover; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);"
                    onerror="this.src='https://via.placeholder.com/100?text=No+Image'">

                <div style="flex: 1;">
                    <h3 style="font-size: 1.25rem; margin-bottom: 8px; color: #333;">{{ booking[1] }}</h3>
                    <div style="display: flex; flex-direction: column; gap: 5px;">
                        <div style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: #666;">
                            <i class="fa-solid fa-calendar-alt" style="color: #ff1f6a; width: 15px;"></i>
                            <span>{{ booking[4] }} to {{ booking[5] }}</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: #666;">
                            <i class="fa-solid fa-truck" style="color: #26a541; width: 15px;"></i>
                            <span style="color: #26a541; font-weight: 500;">Est. Delivery: {{ (booking[4]) }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div
                style="padding: 20px 25px; background: #fffafc; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 1.2rem; font-weight: 700; color: #333;">â‚¹{{ booking[2] }}</div>
                <div style="display: flex; gap: 10px;">
                    {% if booking[6] == 'Confirmed' %}
                    <form action="{{ url_for('user.cancel_booking', booking_id=booking[0]) }}" method="POST"
                        onsubmit="return confirm('Are you sure you want to cancel this booking?');" style="margin:0;">
                        <button type="submit"
                            style="background: none; border: 1px solid #ddd; color: #999; padding: 8px 15px; border-radius: 10px; font-size: 0.85rem; cursor: pointer; transition: 0.3s;">
                            Cancel
                        </button>
                    </form>
                    {% endif %}
                    <a href="{{ url_for('products.product_detail', product_id=booking[0]|replace('#', '')) }}"
                        style="background: #ff1f6a; color: white; padding: 8px 18px; border-radius: 10px; font-size: 0.85rem; text-decoration: none; font-weight: 600; display: flex; align-items: center; gap: 5px;">
                        Rent Again <i class="fa-solid fa-rotate-right" style="font-size: 0.7rem;"></i>
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% else %}
    <div class="reveal"
        style="text-align: center; padding: 100px 40px; background: white; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 60px;">
        <div
            style="width: 120px; height: 120px; background: #fff0f5; color: #ff1f6a; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 3.5rem; margin: 0 auto 30px;">
            <i class="fa-solid fa-calendar-xmark"></i>
        </div>
        <h3 style="font-size: 1.8rem; color: #333;">No bookings yet!</h3>
        <p style="color: #666; margin-bottom: 30px;">Your dream collection is just a few clicks away.</p>
        <a href="{{ url_for('products.categories') }}" class="rent-btn"
            style="padding: 15px 40px; border-radius: 12px; font-size: 1.1rem; text-decoration: none; font-weight: 600;">Start
            Exploring</a>
    </div>
    {% endif %}
</section>

{% if session.get('show_success_modal') %}
<div id="successModal" class="modal"
    style="display: flex; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); align-items: center; justify-content: center; backdrop-filter: blur(5px);">
    <div class="glass-card"
        style="background: white; padding: 40px; border-radius: 25px; text-align: center; max-width: 450px; width: 90%; position: relative; animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
        <div
            style="width: 85px; height: 85px; background: #26a541; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 40px; margin: 0 auto 20px; box-shadow: 0 10px 20px rgba(38, 165, 65, 0.3);">
            <i class="fa-solid fa-check"></i>
        </div>
        <h2 style="color: #333; margin-bottom: 10px; font-size: 2rem;">Booking Confirmed!</h2>
        <p style="color: #666; font-size: 1.1rem; line-height: 1.5; margin-bottom: 30px;">
            Your order has been placed successfully. ðŸŽ‰<br>
            Our team will contact you shortly for delivery details.
        </p>
        <button onclick="closeSuccessModal()" class="rent-btn"
            style="width: 100%; padding: 15px; border-radius: 12px; font-size: 1.1rem;">
            Great, Thank You!
        </button>
    </div>
</div>

<script>
    function closeSuccessModal() {
        document.getElementById('successModal').style.display = 'none';
    }
</script>

{% set _ = session.pop('show_success_modal', None) %}
{% endif %}
{% endblock %}